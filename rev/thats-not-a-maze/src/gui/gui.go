package gui

import (
	"image/color"

	"fyne.io/fyne/v2"
	"fyne.io/fyne/v2/app"
	"fyne.io/fyne/v2/canvas"
	"fyne.io/fyne/v2/container"
	"fyne.io/fyne/v2/theme"

	"bigmaze/maze/model"
	"bigmaze/maze/gamelogic"
)

const cellSize = 8;
const screenSize = 1000;
const size = screenSize/cellSize

func fillCell(grid [][]color.Color, cell *model.Cell, colour color.Color){
	x := cell.Loc.ColumnIndex * cellSize
	y := cell.Loc.RowIndex * cellSize
	startX := x + 1
	startY := y + 1
	endX := x + cellSize - 1
	endY := y + cellSize - 1
	for cellX := startX; cellX < endX; cellX++ {
		for cellY := startY; cellY < endY; cellY++ {
			grid[cellY][cellX] = colour
		}
	}
}

func drawMaze(mod [][]*model.Cell, endCell *model.Cell, windowSize int) [][]color.Color {
	maze := make([][]color.Color, windowSize)

	// start with drawing background
	for row := 0; row < windowSize; row++ {
		maze[row] = make([]color.Color, windowSize)
		for col := 0; col < windowSize; col++ {
			maze[row][col] = color.Black
		}
	}

	fillCell(maze, mod[0][0], color.RGBA{R:235, G:33, B:33, A:255})
	fillCell(maze, endCell, color.RGBA{R:235, G:33, B:33, A:255})


	for y := 0; y < len(mod); y++ {
		for x := 0; x < len(mod[y]); x++ {
			if (y < 25 && x < 25) || (y > 105 && x > 105) {
				startY := y * cellSize 
				startX := x * cellSize
				endY := startY + cellSize  - 1
				endX := startX + cellSize  - 1

				cell := mod[y][x]

				if cell.Walls.Top {
					for wallX := startX; wallX <= endX; wallX++ {
						maze[startY][wallX] = color.White
					}
				}

				if cell.Walls.Bottom {
					for wallX := startX; wallX <= endX; wallX++ {
						maze[endY][wallX] = color.White
					}
				}

				if cell.Walls.Left {
					for wallY := startY; wallY <= endY; wallY++ {
						maze[wallY][startX] = color.White
					}
				}

				if cell.Walls.Right {
					for wallY := startY; wallY <= endY; wallY++ {
						maze[wallY][endX] = color.White
					}
				}
			}
		}
	}
	return maze
}

func calcPosition(loc model.CellLocation) fyne.Position {
	return fyne.NewPos(float32(loc.ColumnIndex)*cellSize + (cellSize / 4), float32(loc.RowIndex)*cellSize + (cellSize / 4))
}

func byteToWall(b byte) model.CellWalls {
	wall := model.CellWalls{Top: false, Bottom: false, Left: false, Right: false}
	if (b >> 3) & 1 == 1 { 
		wall.Top = true
	}
	if (b >> 2) & 1 == 1 {
		wall.Right = true 
	}
	if (b >> 1) & 1 == 1 {
		wall.Bottom = true 
	}
	if (b) & 1 == 1 {
		wall.Left = true
	}
	return wall
}

func decodeMaze(mazeBytes []byte) [][]*model.Cell {
	count := 0
	maze := make([][]*model.Cell, size)
	for y := 0; y < size; y++ {
		maze[y] = make([]*model.Cell, size)
		for x:= 0; x < size; x++ {
			maze[y][x] = &model.Cell{
				Walls: byteToWall(mazeBytes[count]),
				Loc: model.CellLocation{RowIndex: y, ColumnIndex: x},
				Role: model.CellRolePath,
			}
			count++
		}
	}
	maze[0][0].Role = model.CellRoleStart
	maze[size-1][size-1].Role = model.CellRoleFinish
	return maze
}

func mazeContent(w fyne.Window) *fyne.Container{
	// generated from generate.SetupGrid
	gridBytes := []byte{13,9,10,10,14,9,10,10,12,9,10,10,10,10,10,8,10,14,9,10,8,10,10,8,14,9,8,10,12,11,10,10,10,8,10,10,8,8,12,11,8,14,9,8,14,9,10,8,14,9,10,10,10,8,12,9,10,12,9,12,9,8,10,12,11,8,14,9,8,10,10,12,9,10,10,10,12,9,10,8,10,12,9,8,14,9,10,8,10,12,9,10,10,10,10,10,12,13,9,8,12,11,10,8,10,10,12,9,10,14,9,8,14,9,10,10,8,14,9,10,10,10,8,12,13,5,1,10,10,10,6,9,8,6,5,9,10,10,10,12,3,10,10,6,13,5,9,12,7,9,6,3,12,3,10,10,10,12,7,9,12,5,5,3,10,6,9,6,5,9,6,13,3,10,6,9,12,9,6,5,3,12,5,5,3,6,1,12,3,12,3,10,6,3,8,12,7,3,10,12,13,3,6,9,6,13,5,5,5,9,6,9,6,13,5,3,8,10,12,11,10,4,5,5,5,3,12,9,6,11,12,5,3,10,10,6,1,10,6,11,12,3,10,2,10,14,9,6,3,6,5,5,9,12,11,12,5,7,9,2,6,9,10,12,5,9,10,10,8,4,3,6,5,9,6,9,14,3,10,12,9,14,3,10,6,5,5,3,12,9,10,6,9,6,3,12,5,9,10,12,5,5,5,13,3,10,6,5,7,9,12,7,5,13,3,10,10,10,12,5,5,9,8,14,5,1,10,12,3,12,1,6,5,3,6,9,6,9,6,3,12,3,12,3,10,12,5,3,6,3,12,3,6,9,10,4,3,12,9,10,12,3,12,11,8,6,9,10,10,10,12,5,9,10,12,5,1,6,3,10,4,5,9,6,9,10,6,13,5,5,7,9,12,5,3,10,12,5,5,11,4,9,12,9,6,3,10,8,12,9,6,3,14,3,2,12,13,3,10,10,2,6,1,12,3,6,3,6,1,10,10,14,3,10,6,5,9,6,5,9,10,12,9,6,7,3,4,5,9,6,3,12,3,12,5,5,11,2,12,13,3,12,1,10,10,6,11,2,8,14,5,3,10,8,10,6,9,12,1,12,3,12,3,6,9,6,13,5,9,6,9,6,9,12,9,6,5,5,9,4,5,7,9,10,12,7,5,3,12,3,12,11,4,5,5,9,4,3,6,9,10,6,3,2,10,6,5,5,3,10,10,12,7,1,6,9,12,9,12,11,2,2,8,14,9,10,12,7,3,10,12,9,10,6,9,10,10,10,10,12,5,5,9,6,5,9,6,3,12,9,12,7,5,5,9,10,6,11,4,5,3,10,12,5,5,9,6,5,9,10,10,10,12,5,9,6,9,12,7,9,10,6,5,5,5,11,2,10,12,5,9,2,2,6,9,4,11,6,3,2,12,1,6,5,7,3,10,6,13,3,12,5,9,6,13,3,12,3,4,3,6,5,9,12,5,9,10,10,12,9,12,5,3,10,10,12,1,12,3,10,6,3,6,3,10,12,11,4,9,6,11,2,12,9,12,5,5,9,12,5,9,14,9,12,3,6,5,1,10,6,3,8,14,3,6,3,12,3,2,6,9,10,12,7,3,12,13,5,3,6,5,9,6,5,9,8,14,5,5,3,12,5,3,12,5,9,12,5,5,3,10,10,12,5,5,7,9,10,12,5,7,9,12,9,12,5,3,12,3,12,9,10,14,1,10,6,5,1,10,2,14,3,12,3,10,12,7,5,5,7,3,10,12,3,6,3,6,9,8,14,5,7,3,8,12,13,9,10,10,12,3,12,7,5,9,10,12,3,6,3,6,5,5,5,5,1,10,6,3,10,10,4,3,12,9,12,3,8,10,12,9,6,9,10,10,6,13,3,12,9,6,3,2,12,9,6,3,12,5,5,5,9,6,3,12,3,6,13,3,6,5,3,6,1,10,10,12,5,5,3,10,6,13,5,5,9,6,3,6,5,3,12,3,12,5,1,10,12,5,13,9,2,6,9,10,12,9,6,9,14,5,9,6,3,12,9,10,6,11,8,12,9,6,3,12,3,10,12,7,5,1,6,9,14,3,12,3,12,5,3,12,3,10,12,11,10,2,6,5,5,3,8,10,10,14,9,4,11,2,6,5,9,6,9,6,3,12,3,12,9,10,2,12,5,3,10,12,9,6,5,11,12,3,6,5,7,5,9,14,5,9,12,1,12,13,3,12,11,6,9,12,7,5,3,14,9,12,1,6,3,6,9,10,10,6,13,3,12,7,5,5,13,3,6,3,6,9,12,3,12,5,5,9,2,10,6,1,12,9,6,1,10,10,12,5,7,3,12,13,3,10,12,3,10,6,3,12,5,9,12,1,12,5,5,9,6,9,12,5,9,10,10,12,5,3,12,5,9,12,9,6,7,9,12,11,4,5,11,2,12,9,6,9,6,7,9,12,3,2,10,10,6,5,11,2,12,1,12,13,1,10,6,1,12,5,5,3,6,3,2,12,3,10,12,5,3,12,5,9,10,6,5,3,10,12,9,6,9,12,9,0,12,3,10,4,3,4,11,8,10,10,6,3,12,5,3,6,3,12,13,9,6,5,5,11,4,9,10,6,1,10,12,3,4,9,12,1,10,12,11,12,3,4,5,3,6,5,5,5,5,11,6,5,3,6,9,12,5,3,12,5,7,5,5,1,10,12,5,3,12,5,3,10,12,5,5,9,2,10,10,6,3,8,10,10,10,12,5,9,12,5,5,3,6,3,12,11,4,3,2,6,11,10,10,10,6,9,8,6,3,12,5,3,6,9,12,1,10,12,3,6,9,4,7,5,5,7,9,12,5,9,6,9,6,13,9,10,12,3,6,9,10,12,5,5,5,13,5,3,12,5,5,11,12,5,13,3,12,3,6,5,5,11,0,10,6,9,6,3,12,13,5,5,3,2,10,12,3,8,8,6,7,3,12,5,5,9,6,5,1,14,3,4,9,6,5,11,12,5,7,5,5,9,10,10,10,12,7,9,10,10,6,3,6,3,6,3,10,10,12,3,12,7,9,10,12,9,10,10,10,10,6,5,9,10,6,1,12,9,6,5,3,14,3,10,10,6,3,8,6,3,10,6,5,5,3,10,6,13,1,2,14,5,9,12,1,12,7,5,3,2,4,5,13,5,5,3,12,5,3,4,13,3,8,14,5,3,12,7,9,10,6,13,9,6,3,6,3,10,12,13,5,9,6,5,9,10,10,6,1,6,5,13,5,5,9,12,7,5,13,3,10,4,5,9,6,7,5,9,10,12,3,10,6,9,10,12,9,12,9,10,10,12,9,2,12,3,10,6,9,6,3,10,12,13,9,10,6,5,9,12,7,5,3,12,3,12,9,12,9,10,10,12,3,10,10,10,12,3,6,11,12,9,2,2,14,9,6,5,3,6,3,12,3,10,12,7,5,1,6,7,9,6,3,12,1,2,14,3,12,3,12,3,10,6,9,12,5,3,10,10,10,10,10,6,5,3,6,9,6,5,9,10,12,5,9,6,1,6,7,5,5,9,6,3,10,12,5,3,6,9,10,6,3,12,3,10,8,10,6,11,0,6,3,6,9,10,2,6,13,3,12,9,12,3,12,9,10,6,5,5,9,10,6,5,5,9,4,9,2,14,3,6,3,2,10,12,5,13,9,10,10,6,11,12,9,6,5,9,10,12,3,12,3,12,9,10,4,9,12,5,9,6,3,10,12,5,11,8,6,5,9,10,10,4,9,6,11,10,8,6,3,2,10,10,12,13,9,10,8,2,8,14,5,13,5,7,9,6,3,6,9,6,9,8,6,3,6,9,10,12,5,3,10,10,6,9,10,10,6,9,14,3,10,10,12,7,9,12,11,6,9,10,12,1,14,5,5,5,9,6,3,10,12,3,6,5,13,9,6,3,6,7,5,9,10,8,10,10,12,11,6,5,3,2,10,10,10,10,6,5,9,6,5,9,6,9,0,14,5,5,9,6,5,3,6,5,11,8,12,5,5,9,4,9,6,5,13,9,6,3,10,10,10,6,9,10,14,9,12,5,5,3,12,3,12,5,9,6,5,3,12,3,10,8,12,5,9,4,7,9,10,10,6,9,6,1,12,9,8,14,3,10,10,12,1,8,10,10,14,3,10,6,3,12,9,2,14,5,3,12,5,5,5,3,10,10,12,3,12,9,6,5,5,9,10,10,10,6,5,11,6,9,12,5,9,10,4,9,10,10,10,10,10,12,1,2,14,5,5,11,4,7,9,6,5,3,12,5,11,10,2,12,5,5,3,6,5,7,3,12,5,5,3,12,9,10,12,9,12,1,10,10,6,3,6,5,9,6,9,6,7,3,8,2,14,3,12,9,6,5,5,7,1,12,3,12,9,10,6,9,6,3,6,3,12,9,12,9,6,5,3,10,10,8,10,14,9,12,3,6,9,12,3,12,1,6,7,5,9,10,10,6,9,4,3,10,4,3,6,9,10,12,13,3,10,10,4,5,3,6,11,6,5,9,8,10,8,14,5,5,13,9,6,3,12,3,10,2,14,5,11,6,3,10,10,10,6,5,1,14,9,2,10,12,5,5,3,10,6,5,13,3,6,3,6,9,10,10,12,9,4,5,13,5,9,10,10,6,9,10,10,6,5,11,6,3,12,7,5,9,6,5,9,14,3,10,12,9,12,5,5,3,6,9,6,9,10,10,4,9,10,6,3,10,10,6,3,10,6,3,12,9,4,5,13,9,10,4,5,11,12,5,13,9,4,13,3,4,13,9,12,5,5,9,12,9,12,5,7,5,11,6,9,4,5,5,3,10,12,3,10,12,9,10,6,9,8,12,9,10,10,12,5,7,9,6,9,12,5,5,3,10,10,10,6,3,12,9,10,12,3,10,12,3,6,5,5,5,5,5,9,10,14,5,11,10,10,4,9,8,14,3,12,5,3,12,5,5,9,12,9,6,5,3,4,3,10,12,3,14,5,9,10,6,5,9,10,10,12,9,12,9,8,10,12,3,6,5,5,3,2,12,5,5,9,4,5,3,6,5,5,9,6,5,5,5,5,3,6,3,6,5,3,10,4,9,10,6,7,5,1,10,14,5,11,10,2,6,9,10,6,5,3,6,9,10,6,3,12,3,10,6,5,3,6,11,8,12,11,8,10,6,3,12,1,10,14,5,9,14,3,6,5,3,6,3,10,12,3,12,9,12,1,6,3,10,10,6,1,10,6,5,1,6,3,2,14,5,13,3,12,13,3,10,12,5,5,11,12,5,1,14,9,6,5,5,5,5,9,2,14,9,6,3,12,9,6,5,3,6,5,3,10,10,6,5,3,8,6,5,5,3,10,12,13,9,2,14,9,6,3,10,10,12,1,6,9,10,4,9,10,12,9,6,13,9,6,11,12,3,10,12,9,2,12,11,12,3,12,9,10,6,3,12,5,9,8,12,5,3,10,10,6,3,10,8,10,2,10,12,9,10,2,14,1,6,5,3,12,9,12,11,10,2,10,14,5,5,11,10,12,9,6,1,10,6,1,14,9,6,5,3,10,4,5,5,9,4,9,6,3,6,5,7,9,10,2,10,14,5,5,9,6,9,10,6,9,12,9,8,2,14,5,9,6,3,12,13,5,5,5,9,10,2,12,9,12,13,5,5,9,6,11,6,3,12,3,6,9,4,3,10,12,1,8,14,3,6,9,6,9,2,14,3,6,9,10,10,6,5,5,5,7,5,11,8,8,12,9,12,1,10,12,9,2,6,9,10,12,3,12,5,9,6,5,3,10,12,9,10,10,6,3,10,12,5,5,11,2,12,9,4,9,6,9,6,13,9,6,5,5,5,7,5,9,10,12,3,10,6,9,10,10,12,5,7,5,11,6,9,10,6,3,6,3,10,10,6,5,9,12,5,5,5,5,3,6,9,12,3,6,5,5,5,5,3,12,9,10,12,3,10,10,6,5,9,10,6,5,7,9,10,10,2,10,6,9,12,9,10,6,9,8,12,3,6,3,12,3,12,5,5,3,6,5,5,9,6,5,13,9,6,13,5,9,6,5,3,10,6,9,10,6,5,9,10,12,13,9,6,5,3,12,13,5,5,5,3,10,6,9,2,2,14,5,5,3,10,6,3,14,5,9,10,12,3,10,12,3,6,9,6,9,12,3,10,12,13,9,10,10,12,9,6,5,7,5,3,2,2,10,12,5,3,10,12,3,6,5,5,13,3,6,13,3,10,10,10,10,6,3,12,11,4,9,6,9,10,10,10,10,6,5,5,9,10,6,5,3,10,12,9,2,14,5,5,3,12,13,5,7,5,13,5,5,3,12,5,5,3,14,1,10,12,13,3,10,10,6,5,11,2,4,5,9,2,12,5,3,2,6,3,12,13,9,6,9,12,9,6,3,10,10,10,10,12,5,3,12,5,9,12,5,13,9,4,9,6,3,10,12,5,1,6,9,10,4,5,11,2,12,3,12,13,9,10,6,5,9,12,3,10,10,4,3,4,11,10,0,10,8,10,10,10,12,9,6,9,6,5,13,3,10,10,10,10,12,3,6,3,10,14,5,11,12,5,5,9,10,6,7,9,6,5,3,10,6,5,5,1,14,5,1,6,9,12,7,9,6,3,10,8,12,11,0,10,12,7,3,6,13,5,3,10,12,9,10,2,6,5,11,6,5,3,10,12,9,12,9,14,1,6,9,6,3,6,5,5,5,5,5,3,10,10,12,3,6,7,9,6,13,5,5,9,12,1,12,5,5,5,11,12,3,6,5,9,10,12,5,9,6,9,12,3,14,3,10,12,9,6,5,11,2,10,0,2,10,12,9,12,9,6,9,10,12,9,10,6,9,6,3,4,3,10,10,10,6,11,0,10,10,10,4,3,4,9,6,3,10,6,3,12,5,9,10,10,6,3,12,3,12,5,9,10,10,2,6,9,10,6,1,14,9,12,3,10,12,1,10,12,3,6,5,1,10,6,9,6,11,10,12,3,6,1,6,3,8,12,13,3,10,10,12,5,9,6,5,3,6,5,5,5,5,3,2,10,2,12,13,3,6,13,5,5,3,12,5,3,12,9,8,10,6,3,14,1,10,10,12,7,9,12,5,5,3,6,11,2,12,5,5,11,8,6,9,10,2,12,13,9,8,10,12,3,10,8,12,7,9,6,3,12,9,10,10,12,3,6,5,9,10,12,11,2,12,7,3,2,10,12,9,10,6,11,12,5,9,6,5,9,10,2,6,11,6,9,8,6,3,10,14,3,10,10,12,5,9,12,5,9,8,6,3,2,10,10,14,3,6,1,12,5,9,8,6,7,3,2,10,10,10,12,5,3,8,10,4,5,5,9,2,6,11,2,6,5,9,10,10,12,1,10,14,3,10,6,5,7,3,10,10,10,12,5,3,6,9,6,9,6,9,12,3,6,5,3,12,3,10,12,7,5,9,6,9,10,6,5,11,12,3,10,10,2,6,9,6,9,12,3,10,10,12,13,5,3,10,10,12,3,6,5,13,3,6,9,10,12,9,12,5,7,9,10,10,12,9,10,12,5,1,6,3,6,5,5,9,10,10,10,10,10,10,12,5,3,6,5,5,9,10,12,9,12,11,8,6,3,12,5,9,6,5,5,5,9,10,10,10,12,7,1,12,11,4,7,9,12,9,12,9,6,9,10,10,10,10,6,5,9,14,1,12,5,13,5,3,10,12,5,13,5,11,8,6,9,6,3,12,5,9,12,3,12,3,8,10,12,9,12,3,10,6,5,11,10,8,6,3,6,9,10,12,5,9,12,3,2,8,14,3,12,3,6,3,4,9,6,9,12,5,3,12,3,6,5,9,8,14,5,7,5,11,8,12,9,10,10,6,3,12,9,6,5,3,12,3,6,3,12,3,12,13,3,4,7,9,6,7,5,3,12,9,12,3,12,7,3,12,3,12,5,5,5,1,6,9,6,9,14,9,10,8,6,3,10,4,3,6,5,5,11,12,3,2,6,3,12,3,12,5,9,12,5,5,5,3,14,3,12,5,11,2,6,3,10,12,13,3,10,12,3,10,10,12,1,12,5,5,5,3,10,10,6,9,10,6,13,9,12,5,3,12,5,3,2,12,3,12,11,4,7,3,12,3,10,2,10,6,5,5,9,12,9,10,6,3,12,7,9,6,11,10,12,5,11,4,1,12,5,9,6,9,12,3,12,5,5,5,9,6,9,10,6,11,2,6,3,6,7,9,6,11,0,10,6,9,6,9,10,12,3,10,12,5,5,9,2,8,14,9,12,5,11,2,4,5,3,6,5,5,9,10,10,6,1,10,10,10,12,13,3,4,13,9,6,9,10,14,5,5,5,5,5,3,10,10,12,9,6,9,10,4,5,5,3,12,5,5,11,10,4,13,3,12,5,9,10,6,9,12,11,8,12,5,3,6,5,5,11,10,12,3,10,6,11,8,10,6,3,12,5,7,3,6,1,10,6,5,13,5,5,5,3,2,10,6,9,12,9,12,9,12,9,12,3,10,12,3,12,13,3,10,6,13,3,10,12,5,5,5,5,9,6,9,6,3,4,9,12,7,1,14,9,6,1,6,9,10,10,2,10,10,14,5,5,9,6,5,3,12,3,10,10,4,7,5,5,3,10,8,10,6,3,12,3,14,3,4,3,10,6,5,3,10,12,3,2,14,5,3,6,9,12,5,3,12,7,5,3,12,9,4,3,10,10,2,10,10,10,10,4,9,10,10,6,3,10,10,12,3,14,9,4,1,6,5,7,9,10,10,10,6,5,5,5,5,5,5,1,12,13,5,13,3,2,10,12,11,2,8,14,5,3,6,3,6,3,12,3,10,12,7,5,3,10,6,9,6,13,3,12,3,14,9,10,10,12,9,6,3,2,12,3,12,5,9,10,12,5,9,6,5,9,12,3,10,10,12,3,12,9,12,3,12,9,14,5,9,14,3,10,10,10,6,9,10,6,5,3,12,5,9,4,9,6,5,3,14,9,10,12,9,10,8,14,5,5,13,9,8,10,10,14,5,9,12,5,5,5,13,3,12,5,9,10,12,9,6,5,5,5,3,6,5,1,6,5,1,12,9,10,2,10,12,3,12,3,10,8,14,9,12,5,9,12,3,10,6,11,12,9,6,11,0,12,3,10,10,6,9,10,6,3,10,10,12,3,10,4,3,6,13,5,5,5,13,3,6,5,9,10,12,3,14,3,6,5,13,1,6,9,6,1,8,10,10,10,12,11,4,9,10,6,9,6,5,5,7,1,14,3,10,10,2,12,3,2,14,3,8,6,5,3,4,3,10,10,12,3,6,5,5,7,1,2,14,5,5,5,11,4,3,12,5,3,6,13,9,6,5,9,6,5,5,5,9,10,12,3,10,2,10,14,3,10,6,5,5,5,5,9,8,10,10,4,3,10,12,7,5,9,10,8,14,3,12,9,10,10,12,3,12,11,2,12,11,4,5,5,5,3,10,12,3,6,13,3,12,9,10,10,6,3,6,9,6,13,5,5,11,8,14,5,9,6,3,10,10,6,13,5,1,12,5,9,12,9,10,12,7,9,10,10,12,5,13,3,12,5,13,9,10,2,12,9,6,1,12,7,9,12,5,5,3,12,3,12,5,3,10,12,5,3,12,7,5,9,4,7,5,3,12,3,10,12,9,10,10,10,10,12,5,3,6,5,7,5,9,10,6,9,10,6,9,6,3,12,3,10,10,0,6,11,10,0,10,6,9,12,3,10,6,5,3,6,9,10,6,9,10,4,9,6,5,9,10,10,10,12,5,9,2,6,3,12,3,12,5,5,9,8,10,10,14,1,6,5,3,6,5,5,5,11,4,9,6,13,9,6,3,4,13,5,5,5,3,10,12,7,5,11,4,5,9,6,3,4,5,13,5,11,2,6,9,10,6,1,12,3,12,5,5,5,9,6,13,5,9,12,5,5,9,8,12,13,5,1,12,9,6,9,6,5,9,10,6,11,8,4,9,12,5,13,9,12,7,9,10,12,7,9,10,6,3,10,12,9,6,11,10,4,9,10,6,13,3,6,9,4,5,11,10,12,3,6,3,14,9,12,5,9,6,5,5,5,5,9,10,10,6,9,2,10,14,5,5,3,12,3,6,11,4,3,12,11,2,6,5,1,6,9,12,3,12,3,12,7,5,3,12,13,5,5,5,3,10,10,12,3,10,10,4,3,14,5,5,7,5,3,12,5,3,6,5,3,6,5,5,3,6,5,5,3,6,9,6,11,6,3,10,10,12,5,3,6,3,6,5,5,3,10,6,13,5,9,6,9,10,8,14,5,5,9,10,12,5,3,12,9,0,10,10,6,5,3,10,12,1,10,8,12,9,6,5,5,3,10,2,6,5,7,3,12,11,10,4,13,9,10,6,3,10,6,9,8,10,2,12,3,12,9,10,6,5,9,6,3,12,1,12,3,12,5,9,6,3,4,3,2,12,9,8,6,9,10,12,5,9,10,6,3,12,5,9,6,1,8,14,3,12,9,6,5,9,10,6,3,10,8,6,9,10,12,9,10,10,6,5,9,10,12,11,4,5,11,10,8,6,3,6,9,2,12,7,9,6,5,5,11,2,2,14,5,5,3,12,9,10,6,13,9,6,3,12,5,3,6,9,6,1,10,12,11,12,1,10,10,6,9,12,3,4,5,9,10,12,9,10,6,5,11,12,3,12,5,3,12,11,6,3,8,12,5,7,1,14,3,4,5,9,12,5,9,14,5,5,7,9,6,13,3,6,3,10,12,9,6,3,4,11,6,5,9,10,6,5,13,3,6,9,10,8,14,5,9,6,9,6,5,9,10,12,5,3,12,3,10,6,3,10,12,5,9,8,14,3,12,5,9,6,9,6,1,10,12,9,10,6,3,14,5,3,10,10,4,5,9,12,7,3,12,13,5,13,3,12,3,12,5,3,10,12,11,4,3,12,5,5,7,9,6,5,9,10,6,9,6,9,6,3,12,3,10,10,12,7,5,5,9,6,9,10,6,1,6,5,3,4,9,6,3,12,3,12,1,10,8,10,14,5,3,10,12,3,10,10,6,5,9,10,6,3,8,12,5,9,4,9,6,5,13,5,9,6,5,9,6,5,9,6,9,10,10,12,9,6,3,4,3,10,10,6,5,5,9,4,11,2,14,3,2,10,12,9,12,5,11,10,10,6,3,6,3,10,10,6,1,6,3,12,3,12,5,1,10,12,3,10,6,13,5,7,5,9,6,9,6,3,8,12,3,12,5,9,12,3,12,9,12,5,9,6,3,4,9,6,11,12,3,12,5,11,4,3,12,13,3,10,6,5,11,4,9,10,6,9,10,6,9,10,10,10,6,3,10,10,12,5,7,5,5,7,3,12,5,5,3,6,9,4,5,13,5,3,12,5,9,12,5,3,10,12,5,9,12,11,12,3,6,7,5,9,10,10,10,12,13,3,4,3,6,9,10,10,10,10,10,10,10,8,14,5,9,12,3,10,4,5,3,14,3,10,12,9,2,6,9,6,1,10,6,9,12,7,3,12,5,5,5,3,12,3,6,3,6,5,11,10,4,3,10,12,5,9,6,3,12,3,12,5,3,10,10,10,2,12,7,5,9,12,3,12,9,2,12,11,8,10,10,14,9,6,1,10,6,3,10,10,6,5,1,8,12,7,5,3,6,1,10,6,5,5,5,5,9,10,6,3,6,3,10,4,9,10,10,4,5,9,12,13,5,1,10,6,9,12,5,13,9,10,10,8,10,10,6,9,6,5,5,9,12,7,1,10,12,9,10,4,3,12,11,4,9,2,14,9,6,3,10,10,6,1,6,3,14,1,12,13,9,10,4,9,12,7,9,12,5,5,3,10,14,5,9,6,3,10,12,9,12,9,4,9,6,5,3,10,6,3,14,3,12,3,10,10,12,3,12,3,14,9,10,10,10,10,6,7,5,3,12,3,12,9,6,9,12,5,5,3,6,5,9,10,12,9,10,10,6,5,9,10,6,5,5,3,4,5,7,9,10,6,3,6,5,3,10,12,5,9,10,10,6,11,4,3,6,3,12,7,9,6,5,11,4,13,3,10,6,3,12,9,6,11,8,12,9,12,3,10,10,10,6,3,4,5,13,3,6,3,10,6,3,6,5,9,10,12,5,3,12,9,14,3,6,3,6,5,3,12,3,10,10,12,9,10,12,5,9,10,12,1,14,5,9,10,6,9,10,12,11,8,10,6,13,3,12,3,6,9,6,3,6,5,9,10,4,3,12,3,6,11,8,10,6,5,9,12,5,5,11,6,3,10,6,9,10,10,12,1,12,9,6,5,3,12,9,8,10,6,9,8,14,3,10,6,9,2,12,3,6,9,10,10,10,4,5,9,12,5,3,6,3,14,9,10,12,9,10,6,3,4,11,8,10,10,12,9,10,4,5,9,6,1,12,5,3,8,12,9,10,10,6,13,5,9,10,12,3,6,9,6,5,5,11,2,4,9,6,3,10,10,4,13,5,9,6,9,10,4,13,3,10,10,6,13,9,12,5,5,9,6,9,6,9,10,12,3,12,13,5,5,3,6,1,10,10,10,8,14,1,12,13,5,7,5,3,12,3,12,5,7,3,12,11,6,3,8,14,9,10,6,9,6,9,10,6,9,10,12,5,3,6,5,1,10,10,10,10,6,13,3,2,10,10,12,3,10,6,11,12,3,6,9,6,5,3,12,7,5,3,12,7,5,3,12,9,8,6,3,6,9,4,9,12,3,10,6,3,12,11,6,5,9,12,9,12,3,6,5,5,13,1,12,3,6,9,12,9,8,6,5,3,6,7,5,11,2,10,6,13,3,8,6,3,6,3,10,12,3,14,9,12,3,12,5,5,3,2,10,2,14,3,12,7,3,10,10,6,9,10,10,4,9,6,9,14,3,12,3,12,13,5,11,4,3,14,9,6,1,10,10,10,10,10,2,14,9,12,13,3,10,12,11,8,4,9,12,5,13,1,12,3,10,6,9,2,10,4,9,6,7,5,9,10,10,6,7,5,3,8,12,9,12,3,10,12,3,6,5,5,3,10,10,6,5,1,6,3,10,10,6,3,6,3,10,2,10,10,12,3,12,11,10,10,2,8,6,9,12,9,10,12,3,10,12,5,3,10,6,5,3,12,9,10,10,8,10,6,9,12,9,10,10,4,13,9,6,3,12,3,10,12,3,10,2,6,3,12,3,12,9,6,11,6,9,10,10,10,10,12,9,6,5,1,8,14,5,9,4,3,6,7,3,4,7,5,9,12,9,6,9,12,7,3,10,12,5,3,12,9,12,9,6,13,5,3,6,3,10,10,4,9,12,3,6,9,10,8,12,5,3,10,10,10,12,13,9,12,9,10,12,9,10,6,9,6,9,10,10,12,7,9,6,5,3,12,3,10,10,6,1,10,10,10,0,14,5,3,12,11,6,9,10,6,3,6,11,12,5,5,3,12,9,6,9,10,2,10,10,14,9,10,6,11,2,4,9,10,10,6,9,14,9,12,3,6,9,6,7,3,8,6,5,7,9,10,8,14,5,9,6,5,3,2,14,5,3,10,12,9,6,1,12,3,6,3,2,10,4,3,10,12,13,9,10,2,6,3,14,9,6,9,6,3,6,9,10,10,10,6,5,5,5,3,12,5,3,12,9,6,9,6,11,12,3,12,5,13,3,12,3,10,10,12,11,2,12,9,12,7,9,2,14,3,10,12,5,9,10,8,10,8,6,5,1,10,6,5,11,0,10,10,12,9,12,1,12,9,10,12,7,5,11,8,10,6,9,4,3,10,10,6,9,10,12,3,12,3,10,6,9,6,9,6,5,13,5,11,12,9,6,11,12,3,2,10,6,3,12,9,10,10,12,5,13,9,6,3,2,10,14,9,10,10,2,14,5,9,10,12,5,9,10,10,8,4,5,3,12,5,5,11,4,3,12,5,9,8,2,12,5,3,2,12,5,9,8,14,3,12,13,5,5,3,12,5,9,12,9,10,4,5,3,14,5,9,6,9,4,3,10,12,3,12,5,9,10,4,5,5,7,3,0,14,3,12,3,12,3,12,9,6,5,9,10,10,10,6,13,3,12,3,10,12,9,6,9,6,13,5,5,5,9,4,5,11,8,0,10,14,9,12,11,6,5,9,12,5,5,5,3,10,10,10,8,10,6,9,12,9,12,3,2,14,5,5,7,9,12,5,7,5,13,3,6,3,12,3,10,6,5,7,3,12,5,3,10,10,6,3,6,3,10,12,5,3,4,3,12,5,5,5,3,6,13,5,3,10,10,6,5,13,5,7,9,12,3,12,5,5,5,11,6,5,3,10,12,7,9,8,2,14,5,9,6,5,13,5,5,9,8,10,10,2,12,3,10,12,5,3,12,5,9,4,5,3,2,6,7,3,10,6,5,9,10,6,3,10,10,6,5,7,5,3,2,10,12,9,12,7,9,10,6,5,5,3,12,9,10,6,3,10,6,3,4,9,6,1,10,10,12,3,10,10,10,6,9,10,6,3,12,11,8,10,10,10,10,14,5,3,12,7,9,6,5,5,5,9,12,3,2,10,8,10,14,3,4,3,10,6,5,9,6,5,7,3,10,12,3,12,13,3,10,6,5,9,10,6,3,12,5,1,6,5,5,3,10,10,12,5,9,12,5,3,10,4,5,7,5,1,12,9,12,9,10,10,10,6,1,12,11,8,8,14,9,4,9,6,9,10,12,7,5,3,10,6,13,9,6,5,11,2,6,11,10,12,9,10,12,5,3,12,5,11,12,1,10,10,10,10,10,6,13,9,10,6,9,6,9,10,10,10,12,3,10,2,10,6,11,2,4,5,5,3,12,13,9,6,9,10,10,6,11,10,12,5,1,14,3,10,10,10,4,13,5,5,9,10,10,6,3,10,10,12,5,5,7,9,6,5,9,10,8,6,7,5,3,6,9,10,6,3,12,5,7,3,6,3,2,14,9,10,12,7,5,9,4,7,9,6,3,6,11,2,12,3,10,6,9,10,10,4,5,11,2,10,12,9,10,10,6,5,13,3,2,14,5,1,12,3,6,9,10,10,12,9,10,6,3,10,12,1,12,3,12,11,12,3,12,9,10,12,9,12,9,6,3,6,9,6,3,6,9,6,11,10,8,10,12,5,5,7,9,10,10,10,12,5,5,5,3,2,8,10,10,12,9,10,6,5,3,12,3,12,5,5,11,4,9,10,6,11,12,3,10,10,12,3,4,9,10,10,10,10,10,6,13,3,10,6,5,5,9,6,9,10,10,10,10,6,9,14,9,6,13,9,6,5,9,12,9,6,3,12,9,10,6,3,10,12,9,6,7,3,10,10,2,14,9,6,5,9,8,10,14,5,7,3,10,2,10,2,14,5,5,13,3,6,5,3,12,9,12,5,9,10,10,6,9,10,10,6,13,5,5,3,10,6,9,10,10,4,5,5,3,12,11,6,9,12,7,3,10,12,3,12,3,10,6,7,3,12,7,3,10,10,12,3,8,8,14,3,12,5,1,12,11,10,10,12,9,2,8,12,9,6,7,5,11,0,10,10,10,10,12,5,9,6,9,4,3,10,6,5,3,6,9,8,4,5,11,8,8,10,4,5,9,8,10,10,12,9,10,6,13,1,6,5,9,10,6,9,10,10,10,10,10,8,6,5,1,10,12,3,12,3,6,5,3,6,9,10,10,6,9,10,12,1,2,2,10,10,14,3,12,9,6,3,4,13,3,10,10,6,3,10,12,9,6,9,4,11,8,10,10,12,5,9,10,10,10,6,9,6,5,9,10,6,5,5,5,9,10,10,6,5,13,5,3,6,9,12,3,12,5,13,9,10,10,6,1,6,11,4,3,12,11,8,6,9,12,5,5,7,3,12,5,5,9,6,5,7,5,9,12,5,5,13,9,2,2,14,5,3,12,13,1,12,9,10,12,9,6,9,6,5,11,4,13,3,10,12,5,9,12,3,12,9,12,1,14,3,2,12,9,12,9,10,10,6,3,14,9,6,1,10,10,10,10,8,12,5,5,9,4,3,12,1,12,13,3,4,3,10,12,9,12,5,11,6,5,13,9,6,5,5,3,10,8,10,2,6,1,10,10,6,3,12,5,3,4,3,12,9,14,3,10,10,6,13,3,10,6,9,4,7,5,3,10,12,5,7,5,5,13,3,12,3,6,5,3,6,1,6,13,9,10,0,14,5,5,5,5,1,14,3,2,14,5,9,2,12,3,6,9,10,6,3,6,3,12,5,5,7,5,9,10,12,7,5,5,1,10,10,8,10,12,5,11,2,12,9,10,10,6,7,3,6,5,3,12,5,7,5,1,12,5,9,12,3,6,5,1,10,10,2,6,5,13,5,5,9,12,5,9,10,12,7,9,10,10,12,5,5,11,6,9,6,5,9,10,10,10,10,0,14,9,10,6,5,9,6,9,10,6,5,9,6,5,3,12,5,9,10,6,9,10,2,10,6,5,9,6,9,6,3,6,5,7,9,10,12,9,6,3,14,3,10,8,6,9,10,10,10,12,3,6,3,10,6,3,12,3,12,5,5,7,9,12,3,12,5,3,10,12,5,3,10,10,10,10,10,10,2,14,5,5,9,6,5,7,5,7,3,8,12,5,3,10,14,9,10,6,5,5,3,6,5,5,5,13,3,10,6,9,10,6,3,2,10,10,6,9,4,5,13,9,10,8,6,9,6,9,12,5,5,13,3,10,12,3,6,13,3,10,4,3,6,9,10,6,9,10,10,10,6,5,13,5,11,8,12,5,9,6,13,1,6,9,10,10,10,12,3,10,6,9,10,14,3,10,12,9,10,10,8,6,11,2,4,3,10,6,5,11,6,1,10,12,5,3,10,10,10,12,9,10,12,9,10,6,3,6,9,2,12,3,10,12,5,5,5,9,12,9,6,9,8,4,3,12,13,5,7,5,1,12,13,9,4,9,10,10,12,11,8,10,6,7,5,5,5,9,6,9,6,11,4,7,3,6,3,8,12,3,8,12,1,8,14,5,9,10,2,10,14,5,9,10,12,9,2,6,3,10,6,5,5,3,12,3,6,9,6,13,9,10,6,11,8,14,1,10,10,10,12,5,5,9,10,6,9,10,12,7,9,12,11,2,10,10,6,9,6,3,12,11,8,12,3,6,9,6,5,9,10,10,14,3,12,3,10,10,6,5,7,5,5,3,6,9,6,5,5,13,5,5,5,9,6,5,3,4,5,7,3,10,12,3,12,5,9,10,12,5,5,5,3,12,3,10,12,3,10,8,8,12,7,1,12,5,5,7,3,12,5,7,9,10,12,9,4,5,13,5,3,14,9,10,10,12,5,3,12,3,12,9,6,9,6,3,10,10,12,5,9,2,10,14,9,6,3,6,5,11,12,5,13,3,12,5,3,12,9,12,9,10,6,9,12,3,12,5,5,9,10,6,9,6,3,10,10,8,14,5,9,10,10,12,3,12,3,6,9,14,5,13,5,7,5,5,5,3,6,11,2,12,5,3,8,10,12,3,12,5,1,6,13,3,2,6,5,13,1,10,14,3,10,12,5,5,3,10,6,5,5,5,9,12,5,3,10,6,13,5,5,7,3,4,3,10,10,6,9,10,4,3,10,4,13,3,6,9,4,9,10,10,12,5,1,6,9,10,12,5,9,10,10,4,9,4,3,2,12,3,2,14,5,5,3,2,8,10,6,7,9,6,5,3,2,10,12,3,12,9,10,12,5,9,6,1,12,11,2,10,4,11,10,2,12,5,5,3,12,3,2,2,10,10,10,10,6,1,14,3,12,1,14,5,5,3,10,6,9,8,10,6,3,6,9,10,10,10,6,7,3,10,10,12,5,5,3,6,1,6,9,10,10,2,6,5,9,10,6,9,14,9,12,3,12,5,9,14,3,4,9,10,4,5,5,11,8,2,6,5,9,6,13,5,3,6,9,12,1,6,3,14,9,6,9,10,8,6,7,9,12,7,9,10,12,5,9,6,9,10,12,7,9,6,1,12,3,6,3,12,5,3,10,10,12,3,10,10,12,1,6,3,12,5,9,10,12,11,10,10,12,9,6,9,10,6,5,9,6,3,10,12,9,6,7,9,10,12,9,6,9,12,9,8,10,12,9,12,5,5,3,10,12,5,9,6,11,10,10,8,4,5,9,12,5,9,6,5,9,6,1,6,9,12,5,3,12,5,7,3,12,5,9,12,5,3,12,5,3,10,10,6,5,7,9,10,12,3,12,5,11,6,9,10,6,3,10,6,9,6,5,7,9,6,13,5,9,6,13,5,3,10,12,9,6,3,10,14,9,6,9,10,12,5,3,10,10,6,5,3,12,3,12,9,12,3,2,14,3,10,12,5,5,9,10,14,5,5,9,10,6,9,6,3,12,5,5,5,5,9,6,5,5,5,3,10,12,5,7,3,10,8,10,10,6,5,5,5,5,1,6,9,6,5,9,6,9,6,5,3,12,7,3,8,14,5,7,5,5,3,12,3,2,10,12,9,12,3,12,3,12,1,12,5,3,10,10,6,9,12,9,10,14,3,12,5,9,6,9,2,6,5,9,2,6,9,14,5,3,12,9,10,10,6,13,5,9,6,5,9,10,10,12,5,9,6,13,3,6,5,9,10,10,10,10,6,5,5,5,9,10,6,1,6,9,12,3,10,10,6,5,3,6,5,3,12,5,5,3,12,13,5,5,9,12,9,6,9,12,11,6,3,6,5,3,14,5,9,6,5,9,6,13,1,14,3,10,12,3,12,3,12,5,5,13,5,13,9,10,6,5,3,12,3,10,6,5,5,5,11,8,12,11,4,5,3,10,10,12,3,6,5,11,4,11,8,6,3,10,10,4,9,2,12,3,6,9,14,9,2,6,3,10,6,5,11,10,4,5,5,11,0,12,9,6,5,9,12,9,10,12,5,3,4,5,9,12,3,12,7,1,10,12,13,9,6,9,14,3,12,3,6,3,10,6,5,5,3,6,3,6,13,5,3,12,9,8,14,5,9,8,6,3,12,7,5,11,4,3,12,9,10,6,9,2,14,3,6,5,5,3,4,3,10,10,6,13,3,12,9,10,6,7,3,12,5,1,10,6,3,10,12,9,2,12,13,1,12,3,10,6,9,12,13,9,6,3,12,3,10,10,6,9,6,9,10,8,12,13,1,10,12,3,6,5,9,6,7,5,11,4,5,5,3,12,5,3,14,5,5,7,3,10,2,12,3,12,5,3,2,12,5,9,12,3,8,10,12,9,12,1,6,11,8,10,10,6,5,13,5,5,3,10,6,5,7,9,8,6,9,6,9,2,14,5,5,9,8,6,9,10,10,8,6,3,10,4,9,10,10,12,1,10,6,3,10,10,12,9,6,5,5,9,12,11,10,2,6,11,2,4,5,3,10,12,9,6,5,5,3,12,13,3,10,10,12,9,6,9,6,9,6,1,6,1,14,3,10,12,5,1,10,10,4,9,6,5,1,12,5,3,12,9,6,3,10,10,12,11,2,10,6,3,12,13,5,5,5,3,12,5,9,6,7,3,2,10,10,4,9,10,10,6,5,5,3,12,9,10,6,9,6,7,9,6,9,6,9,12,5,3,6,5,9,6,13,9,6,9,10,12,3,6,11,12,5,3,10,12,9,8,14,3,6,11,4,5,5,3,10,10,10,10,10,12,7,3,10,12,3,6,9,6,1,14,5,3,10,8,12,3,6,11,6,9,6,13,5,9,6,9,10,10,4,5,7,9,12,3,6,9,6,5,7,3,12,3,6,11,10,10,12,3,10,12,9,10,12,5,1,2,6,5,9,6,7,3,10,10,8,12,11,10,6,3,10,10,12,5,3,10,6,1,10,12,3,10,12,3,12,5,9,6,5,3,10,12,5,5,9,2,2,14,5,13,3,10,10,12,3,0,10,14,5,5,3,8,12,11,8,6,5,3,12,13,9,10,12,9,6,9,10,12,5,11,12,3,12,1,12,3,10,10,6,5,9,10,8,12,5,11,2,6,5,9,6,9,12,5,1,10,6,5,9,10,6,13,3,8,12,5,11,10,8,10,10,4,9,10,6,5,13,5,5,3,14,9,6,3,10,10,10,10,12,7,3,12,9,10,12,9,10,6,1,10,10,14,3,12,3,10,12,3,12,5,3,6,9,2,10,14,3,6,5,3,14,9,10,6,5,9,10,12,3,12,7,9,10,6,3,12,5,3,10,6,13,5,9,6,1,2,14,5,3,12,3,12,3,2,10,2,14,5,5,1,10,12,11,12,5,1,14,5,5,3,12,9,10,6,5,13,5,3,6,5,9,10,6,3,10,10,2,12,5,7,5,9,12,5,13,9,6,5,11,10,4,5,5,5,9,10,6,13,9,8,10,10,14,5,9,10,4,5,13,5,5,9,12,1,10,10,12,9,2,10,14,1,12,3,6,9,12,1,10,10,8,8,14,3,10,12,5,13,9,2,6,13,3,12,3,10,6,9,10,12,5,5,11,10,8,6,5,3,12,5,13,9,4,13,3,10,2,14,9,10,10,10,6,5,3,12,3,10,4,5,7,9,6,3,12,1,2,14,9,6,1,6,11,12,5,3,10,10,10,10,12,9,6,3,10,6,5,3,6,5,5,13,3,10,12,3,6,3,2,6,9,12,3,6,1,12,9,12,3,4,11,6,5,5,5,5,5,3,2,10,14,5,3,12,9,10,6,3,10,10,6,5,7,9,12,7,3,10,10,12,3,6,5,3,10,10,4,13,3,10,12,9,6,13,5,5,3,10,12,3,10,2,14,5,5,5,5,3,2,10,12,13,9,6,9,12,9,10,6,13,3,10,12,7,3,10,6,9,12,5,7,9,12,5,11,2,10,10,6,3,12,9,10,10,14,3,6,11,8,10,10,6,13,9,4,3,2,10,12,3,10,10,10,10,10,6,3,10,12,7,3,6,1,12,5,9,10,6,5,3,6,5,9,12,9,8,2,14,5,3,12,9,10,10,10,12,3,10,6,3,10,10,10,12,1,10,12,1,8,14,9,2,6,9,8,6,3,10,4,3,2,14,9,4,9,10,10,10,6,1,6,3,10,12,9,2,6,5,13,5,3,6,9,10,2,10,14,3,10,8,10,10,6,5,5,9,6,5,3,8,10,10,10,12,13,5,1,10,10,10,10,10,8,6,9,10,12,1,6,5,9,8,14,5,9,8,10,10,10,10,10,10,12,3,12,9,12,7,3,6,3,10,10,2,10,12,3,6,5,5,7,9,10,2,14,3,2,10,12,13,3,10,12,9,14,9,10,10,6,5,9,6,7,5,9,6,13,9,6,5,9,8,14,5,9,10,12,5,5,3,12,9,10,12,7,9,10,12,5,3,12,9,6,3,2,10,10,6,9,10,10,10,12,9,6,9,10,12,5,3,6,13,3,12,3,10,10,12,5,1,6,3,14,9,10,10,10,6,9,6,13,5,3,14,3,6,3,12,5,5,3,10,12,9,10,12,11,2,14,3,6,3,10,10,10,10,10,10,8,14,3,10,12,7,1,12,5,13,9,10,10,12,13,5,3,10,12,5,3,8,6,11,10,8,6,3,12,9,4,5,11,4,3,12,7,5,3,10,6,1,12,3,4,3,14,3,6,13,3,12,5,11,4,5,13,5,3,10,10,10,10,10,10,6,9,10,10,6,5,11,4,11,6,5,9,10,2,12,3,10,12,9,6,5,5,9,10,12,1,10,10,10,12,5,11,2,2,10,10,10,10,12,5,5,3,10,14,3,2,12,3,12,9,8,10,12,9,12,11,10,8,10,12,3,10,10,12,3,12,7,5,3,4,5,11,12,5,3,2,10,8,6,3,12,5,9,10,12,5,9,12,3,6,5,5,9,2,12,3,12,5,9,10,12,7,5,13,5,9,10,12,9,0,14,5,1,12,5,5,3,2,10,10,12,9,10,12,9,12,5,11,10,10,0,12,5,9,10,6,3,10,14,1,14,9,6,3,14,5,5,5,9,6,3,12,11,12,5,5,9,10,12,11,10,8,10,2,4,3,10,10,12,9,12,5,13,3,6,5,9,2,6,3,10,12,5,11,6,9,10,12,3,12,3,12,3,10,6,1,12,3,4,9,12,11,6,9,10,6,3,6,13,3,6,5,3,12,9,6,5,5,11,4,13,3,6,5,9,6,9,6,3,6,5,13,3,6,3,10,6,5,5,3,6,9,10,10,12,3,6,13,1,6,7,1,10,10,12,5,5,3,2,12,11,8,10,10,4,9,6,11,8,10,4,3,6,5,9,10,6,9,4,5,5,5,13,3,10,12,5,9,12,7,9,8,14,3,6,5,3,4,9,10,6,7,9,10,10,12,5,3,8,10,6,9,4,9,2,12,3,12,9,12,7,1,12,3,6,3,10,12,5,11,10,8,8,2,10,14,5,13,3,2,14,5,3,12,3,2,12,9,6,3,10,6,9,10,12,5,1,12,9,12,11,10,6,3,10,12,3,12,13,5,9,10,2,6,9,12,5,9,12,5,5,3,10,12,3,10,6,13,9,6,3,10,12,5,9,6,9,10,6,5,11,10,4,5,5,5,3,4,9,12,5,5,5,3,10,6,3,10,10,10,6,13,5,3,10,12,9,6,9,12,5,3,12,7,9,10,6,7,5,11,6,9,6,5,3,12,7,3,12,9,8,14,5,1,10,12,7,3,8,10,10,2,2,14,9,12,3,10,6,9,14,5,3,12,9,10,12,3,12,3,6,5,3,6,3,8,10,10,8,10,6,9,6,3,4,3,12,9,10,6,5,3,6,7,5,1,10,14,1,10,10,12,1,2,10,14,9,6,5,5,13,5,9,12,1,10,10,6,7,5,1,10,6,5,3,6,5,3,10,10,12,9,10,8,14,9,4,3,12,13,5,5,11,4,5,3,12,3,10,6,9,10,10,6,9,10,6,9,6,13,3,10,10,6,5,3,12,5,5,13,3,10,12,1,14,9,10,12,9,6,3,10,10,12,1,10,6,13,3,6,9,2,14,5,9,8,6,9,10,12,7,9,12,7,9,12,3,10,12,5,11,6,5,9,14,5,9,10,10,6,5,9,12,3,14,9,6,5,13,9,10,6,9,6,3,4,5,5,3,6,9,10,10,10,6,3,10,14,3,10,12,5,9,12,13,5,7,9,4,9,6,3,12,5,5,3,6,9,6,5,13,3,10,12,9,6,9,10,10,6,9,8,6,9,2,8,10,12,13,5,13,3,6,3,6,9,10,6,7,9,6,13,3,6,9,10,10,12,5,3,10,12,1,10,14,3,10,10,6,7,5,9,6,13,3,10,6,3,10,6,3,10,10,6,3,10,12,5,1,10,6,3,10,8,12,7,5,3,12,9,6,11,2,6,3,12,11,2,12,9,6,5,7,9,10,6,13,9,10,8,12,9,12,9,12,5,5,5,1,6,3,12,5,7,5,13,9,6,3,2,12,9,6,13,5,1,10,14,5,5,9,6,9,14,9,6,3,12,3,12,3,12,1,6,3,4,11,8,8,10,4,9,10,10,6,9,2,10,12,5,13,9,6,1,10,12,5,5,9,8,10,10,12,9,12,5,3,12,1,8,10,10,14,9,8,12,9,12,9,10,12,3,6,3,10,10,10,12,7,1,12,3,12,5,3,10,8,10,12,9,2,10,10,6,3,12,3,10,6,9,10,2,2,14,5,5,5,3,6,3,6,3,6,5,9,10,6,1,12,5,5,5,9,10,10,6,5,11,4,5,3,10,12,5,3,6,9,4,9,6,11,12,5,13,1,14,5,7,9,12,3,12,7,3,12,7,5,9,10,14,1,12,9,6,5,5,5,13,5,11,6,5,5,5,3,12,9,6,5,3,6,9,6,5,3,10,10,10,6,5,7,5,3,6,13,1,8,10,10,10,10,14,3,12,5,3,10,6,3,10,12,1,14,3,2,14,9,10,10,12,7,9,12,11,6,9,12,9,10,4,3,6,9,10,10,10,12,9,6,5,13,9,6,3,6,5,5,5,11,8,10,6,9,6,3,12,9,4,1,10,12,5,3,6,9,12,5,5,1,6,9,6,9,6,3,12,5,9,12,3,12,5,3,10,12,5,5,3,10,6,5,5,5,3,10,10,6,5,5,13,5,3,10,6,9,12,3,12,5,9,10,10,8,12,3,12,5,9,10,4,5,5,9,10,10,10,10,12,5,5,11,10,8,12,13,5,7,9,10,10,10,6,9,14,3,12,5,3,10,8,6,3,6,11,6,9,12,3,12,13,9,6,7,9,6,5,5,9,10,10,4,3,6,9,6,13,9,2,10,12,3,6,5,3,12,7,5,11,8,4,3,6,5,5,13,3,10,6,9,12,3,2,6,3,10,4,5,9,12,3,6,5,9,12,9,2,6,3,10,10,10,10,4,5,5,3,12,9,10,6,3,12,5,5,7,9,12,7,3,12,5,5,5,9,6,5,7,3,12,9,10,12,3,6,3,10,10,6,3,4,5,9,6,9,12,9,12,3,12,9,4,3,10,12,5,9,10,10,10,10,6,3,10,6,5,3,10,12,3,12,3,2,6,9,12,3,10,10,6,11,4,5,11,12,3,8,12,3,12,3,10,2,10,6,5,9,10,6,3,4,11,10,10,6,1,12,9,10,10,12,7,5,5,3,10,12,3,6,5,5,11,8,8,10,10,10,12,3,2,6,9,6,3,12,11,10,2,6,3,12,5,5,9,10,4,5,5,5,3,12,3,8,12,5,5,13,3,12,9,10,10,10,10,12,7,5,3,12,5,3,4,3,10,6,5,7,9,10,6,7,3,12,11,10,10,8,12,9,8,4,11,12,1,12,3,12,9,10,6,5,9,8,12,9,10,6,5,9,4,9,6,7,9,2,10,12,9,10,12,7,5,9,12,11,2,10,12,9,12,7,5,5,9,14,3,12,3,6,9,12,3,10,10,6,3,12,7,5,9,10,10,2,10,10,12,1,8,12,3,10,12,9,8,14,5,5,5,5,9,6,5,3,6,13,5,13,5,7,3,6,1,12,3,6,11,8,12,9,6,9,2,12,3,6,9,6,9,10,12,3,12,5,9,10,10,12,3,12,9,10,6,5,5,5,3,10,6,5,5,13,5,3,10,12,3,6,5,1,6,9,12,5,5,5,3,10,10,6,9,12,7,5,9,6,9,6,5,3,12,9,12,3,6,3,10,6,5,3,12,9,4,9,10,4,3,10,10,10,10,12,3,12,5,7,9,10,10,10,12,5,7,5,3,12,9,6,7,3,12,3,6,3,6,3,12,3,12,9,4,5,5,3,10,10,10,6,3,12,9,8,6,7,1,10,6,11,2,12,13,5,13,3,12,3,10,4,1,6,9,14,3,10,6,5,11,10,6,5,5,9,10,8,6,3,6,5,11,10,6,9,10,6,7,9,6,5,3,6,3,12,9,10,12,5,3,10,6,5,11,2,8,6,13,3,6,5,9,10,10,10,10,2,10,6,5,5,3,12,5,11,8,14,9,12,5,13,5,3,10,4,9,10,10,6,5,9,6,13,5,3,12,9,10,6,9,8,10,12,13,3,12,3,6,3,6,1,10,12,11,10,8,12,5,5,3,12,9,6,9,10,10,12,1,6,3,4,9,6,11,10,4,3,12,3,8,10,14,9,2,10,10,10,6,5,5,11,6,9,10,12,3,10,10,12,3,8,10,10,2,12,3,10,10,10,6,5,9,6,5,11,8,14,5,9,12,3,10,2,10,14,3,2,10,10,12,9,10,10,12,5,7,9,6,3,12,1,10,6,3,6,5,3,10,12,5,3,12,11,10,2,6,9,6,5,9,6,3,8,10,6,5,9,2,6,9,6,9,10,10,10,4,13,5,9,12,7,5,3,2,14,3,2,12,5,13,9,6,5,9,10,6,3,10,10,12,5,13,3,12,3,10,8,2,10,14,9,10,8,6,5,9,12,3,12,5,9,10,12,3,12,7,9,10,12,5,9,12,9,10,10,6,5,9,2,12,1,10,6,5,5,9,8,10,10,10,12,11,10,12,5,3,10,12,3,6,9,6,13,9,6,3,12,11,10,8,6,9,10,6,1,14,5,9,10,12,9,4,9,6,3,10,12,1,14,9,6,5,9,12,5,13,5,13,9,10,6,3,4,5,3,12,1,10,14,9,10,12,7,3,4,3,12,7,5,9,8,12,11,12,5,5,1,12,3,10,12,5,13,9,8,6,11,6,9,6,5,3,10,6,3,2,14,1,12,5,9,6,11,4,7,5,3,6,11,8,14,5,3,14,5,3,10,10,6,5,5,7,9,12,11,2,10,12,1,6,9,12,3,10,10,6,9,4,3,12,11,2,10,10,4,9,6,9,12,5,9,6,1,14,5,5,7,5,9,10,14,5,7,9,6,13,5,5,5,5,3,2,4,3,12,9,12,3,6,9,6,5,9,10,6,13,3,8,14,3,12,5,9,6,5,5,3,10,4,5,5,5,3,10,10,6,1,6,5,7,9,10,12,3,12,5,13,9,10,10,10,8,6,7,5,3,10,12,3,12,5,9,10,12,3,10,2,10,12,1,10,10,12,13,5,1,10,6,3,12,9,12,5,3,12,5,1,10,10,10,10,6,3,12,3,10,10,12,13,5,3,12,5,3,6,3,12,5,9,6,3,12,5,1,10,12,3,12,1,12,3,6,5,3,2,12,9,6,9,6,5,5,13,9,6,11,4,3,12,11,0,12,3,10,10,6,3,6,13,5,5,9,10,6,5,7,5,11,10,8,12,7,9,6,9,6,13,3,12,3,6,5,3,12,13,9,6,9,10,6,9,10,6,9,6,3,2,12,3,10,10,12,13,5,7,9,10,6,5,5,3,14,9,10,6,7,5,5,13,5,5,7,9,10,10,12,9,12,3,12,13,9,6,3,2,14,5,1,10,10,12,3,6,1,10,12,1,6,3,12,3,12,5,7,5,9,10,6,9,12,5,3,14,5,9,6,5,5,3,10,12,3,12,3,12,5,3,10,8,10,10,10,12,3,6,5,3,10,12,3,12,3,10,10,6,3,12,1,12,5,9,0,14,3,10,8,4,13,5,3,2,14,5,9,12,3,12,13,3,12,9,12,1,14,9,10,4,3,2,10,6,11,10,4,3,10,12,5,11,8,8,6,5,1,6,3,10,2,14,9,6,5,3,12,5,5,3,10,10,12,9,6,5,9,12,7,9,12,7,9,6,3,10,12,3,12,5,3,12,3,6,9,10,6,5,3,10,12,1,6,9,6,1,10,12,3,12,1,12,5,3,12,11,6,9,10,12,5,9,12,3,12,9,2,14,5,9,10,10,10,12,5,7,1,6,5,5,9,10,10,6,3,4,3,10,10,10,6,5,3,10,6,3,12,3,6,5,7,9,6,11,6,9,10,10,12,9,10,2,10,12,5,3,12,7,5,9,6,3,10,10,10,10,12,1,12,7,9,4,5,1,10,10,12,5,3,12,5,5,3,10,6,5,9,6,9,10,12,5,13,5,3,12,5,9,10,6,9,12,3,10,12,5,5,13,5,13,3,12,1,12,5,7,5,3,10,4,9,10,6,13,5,5,5,3,10,6,5,9,12,5,1,10,10,12,7,3,12,3,12,5,5,3,12,9,8,14,5,13,9,8,10,10,4,9,10,10,12,5,9,12,3,12,5,9,10,10,6,9,12,5,5,13,9,10,6,3,10,6,9,6,5,9,14,9,10,10,10,6,7,5,9,6,5,5,7,9,12,5,5,9,6,5,5,9,14,9,6,5,9,6,13,3,6,3,2,14,5,3,6,13,9,6,3,10,10,6,5,3,6,5,1,10,6,5,7,5,9,6,9,10,6,5,9,10,4,5,3,6,9,10,12,7,5,5,5,1,10,14,1,8,12,5,11,2,6,1,14,5,5,7,9,6,1,6,3,10,12,7,5,9,12,5,1,6,3,10,2,4,3,12,11,10,4,7,5,5,3,2,10,12,9,10,10,2,12,5,1,10,6,9,10,10,8,10,6,5,11,6,3,12,5,3,6,3,6,13,5,5,1,10,6,11,4,3,10,4,9,8,10,12,9,4,11,10,4,5,9,10,12,9,12,3,12,9,6,1,10,14,3,10,2,4,9,6,9,10,6,5,11,6,3,10,10,6,13,5,9,6,3,4,5,9,12,7,5,7,3,10,12,11,6,9,6,3,8,6,11,2,10,12,13,3,10,4,5,5,5,3,14,9,12,11,2,14,3,8,10,6,9,6,1,10,12,11,4,3,10,10,12,3,6,3,10,12,7,9,12,5,13,9,2,10,8,14,5,1,10,8,10,12,1,6,5,3,10,10,10,6,13,9,6,7,5,13,5,5,3,10,12,5,5,3,14,3,6,3,10,2,6,11,6,9,12,9,10,12,7,5,9,6,13,9,2,10,10,10,10,10,12,1,6,3,12,13,5,5,5,3,10,4,9,10,10,6,9,12,1,10,12,3,10,12,11,10,2,6,9,12,3,6,5,3,10,10,6,3,8,10,10,10,6,9,10,6,11,4,13,3,12,5,11,8,12,3,10,10,10,12,5,9,6,3,6,3,2,10,14,1,12,5,7,9,6,13,5,5,13,3,10,12,11,12,9,2,6,9,10,6,3,2,6,13,9,6,5,3,10,12,9,10,12,9,10,10,10,10,6,3,6,13,3,12,5,5,11,2,2,10,14,9,10,10,12,3,2,12,9,6,3,6,5,3,12,9,6,5,9,10,10,6,5,1,14,3,8,12,3,10,10,12,9,6,5,11,10,2,8,14,9,10,12,3,14,9,10,12,3,10,10,12,3,2,14,5,3,10,6,5,9,10,12,9,6,3,6,9,12,11,8,10,10,12,7,5,5,9,6,9,4,5,3,6,9,12,3,12,5,3,10,12,3,10,10,12,9,8,6,5,9,6,9,12,3,4,9,6,3,12,11,10,10,10,10,8,2,14,5,5,3,12,9,10,10,10,2,10,12,3,10,12,1,6,9,10,12,5,9,6,3,14,3,6,9,10,12,5,5,9,12,7,5,9,10,12,3,6,13,5,9,10,12,5,9,6,13,3,10,12,5,9,6,9,10,12,1,12,9,12,5,9,12,9,6,5,13,5,3,10,10,10,6,3,12,5,11,8,2,10,6,5,3,12,7,3,2,10,10,6,3,10,6,3,8,14,3,10,10,10,6,5,3,10,2,6,9,6,3,12,5,3,12,9,6,9,8,10,10,12,3,10,12,3,2,12,3,2,10,14,9,10,12,3,10,14,5,5,9,2,14,5,5,5,9,12,9,10,12,5,9,4,5,5,5,3,10,6,5,13,5,13,9,2,6,3,12,5,7,5,9,2,12,9,6,5,3,12,5,13,5,5,5,5,5,5,5,3,6,9,6,5,3,10,8,14,9,10,12,5,1,12,3,14,9,10,6,9,6,9,10,10,12,13,9,10,8,10,8,6,9,12,9,10,8,14,5,11,12,9,10,6,9,12,5,3,12,3,6,9,6,5,9,12,3,10,12,5,9,12,5,9,12,9,10,6,13,3,10,12,9,6,7,1,14,9,4,5,5,5,3,6,9,4,5,5,5,5,5,3,10,10,12,3,4,5,5,3,12,11,8,6,3,10,6,1,12,7,5,9,6,9,6,5,5,5,7,5,5,3,6,3,12,9,6,11,2,12,9,6,9,6,9,6,5,5,3,12,9,6,11,10,2,10,6,9,10,6,3,6,9,6,11,4,9,6,3,6,13,3,10,6,9,4,5,9,12,7,5,5,11,2,12,9,6,9,6,5,5,9,12,3,6,5,5,1,6,7,5,11,8,6,9,12,5,3,10,12,5,9,6,5,7,5,3,12,9,6,7,5,5,7,5,3,12,11,12,3,10,6,5,1,10,2,10,6,9,12,11,8,6,3,12,3,6,13,5,9,6,5,3,10,6,5,9,10,12,3,6,11,8,10,6,5,9,6,13,3,10,6,3,12,3,6,9,10,10,10,10,10,6,9,8,10,12,3,10,12,5,5,9,10,10,2,8,10,10,6,7,3,6,5,9,6,3,12,11,2,6,13,3,12,5,3,6,3,10,10,6,5,7,9,12,3,12,5,9,6,5,3,10,12,3,6,3,12,5,9,6,9,6,3,10,12,5,3,12,3,12,3,10,2,12,9,12,5,7,9,10,12,9,6,3,12,3,14,9,6,9,10,2,6,1,12,1,12,9,8,6,1,12,3,10,8,10,6,9,10,6,5,9,0,12,11,10,10,2,12,11,4,9,10,10,10,10,12,7,5,9,2,10,10,6,5,5,7,9,10,12,5,9,10,10,10,10,12,5,3,10,12,3,12,9,10,2,10,6,3,12,9,12,11,10,10,2,10,6,3,10,6,1,6,13,3,8,14,3,12,9,10,6,7,1,10,6,9,12,9,4,5,13,5,9,6,9,14,9,6,5,5,3,10,2,14,5,1,10,12,3,12,9,4,9,6,13,9,10,6,5,5,5,5,5,13,5,3,12,9,6,9,10,6,9,12,5,7,5,3,12,9,10,12,3,12,5,1,10,10,10,12,3,10,6,7,9,12,13,9,6,5,9,6,11,4,5,3,10,12,11,10,2,6,9,12,5,9,6,5,11,8,12,9,12,3,6,3,12,9,10,10,10,12,9,12,13,3,12,3,12,3,8,14,5,5,9,10,12,3,12,13,5,5,5,5,5,5,3,6,9,4,9,6,13,5,3,10,10,10,12,5,3,14,3,12,5,5,5,5,11,2,2,10,12,5,5,3,6,5,1,6,13,5,3,14,5,9,10,6,7,3,12,5,11,2,6,11,2,12,3,6,5,9,10,12,3,10,10,10,10,6,5,3,6,9,6,5,9,12,3,2,10,12,3,10,10,10,10,6,5,5,5,9,6,9,6,7,5,3,10,10,12,3,6,9,10,12,3,6,5,1,12,3,12,1,14,3,12,5,3,6,9,6,13,5,5,5,3,6,5,5,1,10,10,6,3,2,10,6,5,9,8,8,14,5,3,12,9,10,6,3,6,5,5,9,10,12,11,6,5,5,9,14,5,1,10,6,3,12,9,6,1,10,12,9,10,6,1,10,10,10,12,13,3,10,12,3,6,13,3,12,9,8,14,9,12,3,10,10,2,10,6,5,3,10,10,12,5,11,12,9,8,10,14,5,5,5,5,11,4,9,10,6,9,8,14,5,9,10,6,13,3,10,10,6,7,5,9,6,1,10,12,5,5,9,12,3,12,5,3,4,3,10,12,5,5,5,9,10,10,12,9,10,10,6,7,5,7,9,6,9,6,5,9,10,8,14,5,5,3,12,3,10,12,5,3,4,9,6,7,9,10,8,6,5,13,1,14,5,5,9,14,1,14,9,10,6,1,14,9,6,9,14,1,10,6,5,3,12,5,1,10,10,8,14,9,10,6,9,12,9,6,3,12,1,6,5,9,10,6,3,4,3,10,4,3,12,9,6,3,10,2,6,13,9,2,12,9,12,9,8,4,5,11,2,12,5,5,3,6,3,12,5,1,10,2,12,9,6,5,5,7,5,9,12,5,5,9,12,9,8,6,9,6,11,2,12,5,5,13,3,12,5,3,10,6,11,12,3,6,11,6,5,9,8,6,13,5,9,6,1,6,9,4,5,1,12,5,9,6,9,12,1,10,6,9,2,12,5,9,12,5,13,3,6,3,12,13,5,9,6,9,10,6,5,5,9,14,5,7,9,4,3,12,9,12,5,9,12,3,12,5,7,9,10,10,12,9,2,2,14,3,6,3,6,5,7,3,12,11,6,5,3,10,12,9,6,5,7,9,12,7,3,12,5,3,10,6,5,5,3,6,5,5,5,3,10,6,9,10,10,6,5,5,1,12,5,3,12,9,10,10,4,9,12,9,12,5,5,5,11,2,6,5,11,6,9,6,5,5,7,3,6,5,9,6,5,5,9,10,6,13,3,6,5,3,2,2,14,9,12,5,3,4,3,10,6,9,10,6,5,1,10,2,10,6,3,14,3,6,5,5,7,5,9,6,3,10,4,11,12,5,3,10,12,9,10,12,9,10,6,9,10,6,9,10,2,12,13,3,6,11,4,9,6,3,10,12,5,1,10,10,10,6,3,12,11,6,5,5,9,8,10,6,9,10,10,6,3,6,7,3,12,5,3,12,13,3,6,3,6,3,6,5,3,12,9,10,6,9,12,5,13,5,3,10,10,10,6,5,13,3,6,3,12,9,2,10,12,3,12,9,12,9,6,5,3,12,3,12,13,9,6,13,9,6,7,9,12,9,10,10,10,10,10,6,3,12,1,6,13,9,12,3,10,6,3,12,9,6,5,9,6,1,10,12,5,11,8,6,11,10,4,1,8,10,10,6,1,10,10,12,3,6,7,9,12,11,10,12,5,9,10,6,5,7,5,9,12,1,10,10,10,10,10,10,12,5,3,10,4,3,10,8,12,9,10,12,5,9,6,5,9,12,5,5,5,5,5,9,14,9,10,12,5,1,10,12,13,5,3,14,9,2,14,5,5,3,6,13,3,12,3,12,1,6,5,11,4,3,12,9,6,3,6,13,9,10,10,10,8,12,5,3,8,6,5,3,10,10,10,12,5,3,12,5,5,13,5,13,3,2,10,6,9,10,12,3,6,7,9,10,12,7,9,12,3,12,9,12,5,3,10,12,5,5,5,9,10,6,9,6,5,5,3,10,14,9,10,10,10,6,1,10,10,6,9,12,7,3,4,9,6,5,3,12,3,6,3,6,3,6,5,1,6,9,6,9,4,5,3,12,3,4,5,9,12,3,10,10,4,5,9,12,3,12,3,12,5,7,9,6,9,6,9,6,3,10,12,11,2,4,9,10,10,6,5,3,12,5,9,6,9,12,13,9,6,5,13,5,5,5,3,2,2,10,14,9,12,1,14,3,12,9,10,2,14,5,9,6,3,10,4,5,3,6,9,14,5,3,2,4,3,10,12,5,9,6,5,9,10,12,3,12,9,12,9,6,9,8,14,5,3,10,12,7,3,10,2,12,3,8,10,10,14,9,8,6,5,9,6,13,5,7,5,9,6,9,6,3,6,1,10,10,12,7,5,5,3,12,1,12,5,3,12,5,9,2,10,2,12,9,10,6,9,12,7,5,9,12,9,6,13,5,7,5,9,6,5,1,6,9,6,5,5,5,3,10,10,12,9,10,6,3,6,9,10,6,3,12,13,9,4,5,9,14,9,6,5,9,10,4,9,6,9,12,7,9,12,5,1,6,9,6,5,13,5,9,6,5,7,5,9,4,7,9,6,9,10,6,9,10,10,12,5,13,3,10,10,10,6,3,12,5,3,10,4,3,12,5,1,12,3,10,10,12,5,9,12,1,10,6,5,13,5,7,5,3,12,5,5,7,9,10,12,3,6,11,8,6,3,10,6,7,3,2,10,6,3,12,3,6,9,6,1,10,6,11,2,6,3,12,9,14,3,2,10,10,12,13,3,10,10,10,4,5,5,5,5,1,12,3,12,5,5,9,6,3,10,6,3,12,5,5,5,5,9,6,9,6,3,2,6,11,0,10,2,6,7,9,6,13,3,10,12,3,12,13,5,3,2,12,11,10,12,9,12,5,5,9,14,3,12,3,6,7,3,12,9,12,7,5,5,5,7,9,10,6,5,3,12,3,8,6,5,3,12,1,14,3,10,10,12,1,10,10,10,12,9,10,12,9,8,14,5,9,10,6,9,6,9,10,10,10,10,10,0,6,9,10,10,10,12,3,2,12,9,10,12,3,4,5,5,5,7,3,10,6,5,7,3,8,10,12,9,10,4,5,3,6,5,5,11,2,12,9,10,10,12,3,10,12,9,12,3,12,1,10,12,3,12,3,4,3,10,12,3,10,12,5,5,3,6,5,5,9,10,6,9,10,10,12,3,4,3,10,6,5,5,9,6,13,9,2,12,3,12,3,10,4,13,3,6,9,10,12,9,6,7,9,10,10,4,3,12,3,6,3,12,5,1,10,12,5,13,5,11,10,12,9,12,7,9,6,13,9,10,6,11,10,6,5,13,3,12,5,5,7,5,9,12,9,10,6,9,10,6,13,5,3,12,7,5,9,10,6,3,10,12,5,3,12,13,3,10,12,7,5,3,12,5,7,9,4,13,3,10,6,13,9,6,11,10,2,4,3,10,10,2,6,3,10,10,6,9,12,3,12,3,12,9,10,6,3,6,9,2,2,14,5,9,6,9,14,5,1,14,9,6,13,5,1,10,12,5,9,10,6,13,5,13,9,10,4,5,7,9,6,3,6,3,10,12,5,5,3,10,6,11,4,3,12,9,12,9,10,6,1,12,5,7,3,12,1,6,5,5,11,10,0,12,9,6,3,12,5,9,6,3,10,10,14,9,6,1,14,3,4,9,12,3,10,6,13,5,3,10,6,5,1,12,11,10,4,3,10,12,9,12,5,13,9,10,10,8,14,9,10,10,4,1,14,5,11,6,3,12,9,12,11,2,12,13,9,4,3,12,1,10,2,6,9,6,9,2,6,3,14,5,5,1,10,10,6,3,4,3,12,7,3,12,5,9,10,10,10,10,2,6,3,12,9,8,10,6,9,6,5,3,6,9,10,6,3,6,9,10,4,5,13,5,3,10,12,7,5,5,9,12,5,3,6,11,8,10,10,12,3,12,1,10,10,6,7,3,10,8,12,5,5,9,8,14,5,5,3,10,10,4,11,12,5,5,5,3,6,5,11,12,3,12,5,9,10,6,7,9,6,9,10,12,3,6,3,12,13,5,5,5,3,14,5,7,9,10,12,5,13,5,11,8,10,10,6,5,7,9,12,9,12,5,13,5,9,10,6,3,6,9,12,9,10,12,9,12,5,5,7,9,12,3,10,6,9,10,6,11,10,8,12,3,12,5,3,6,3,10,10,2,10,6,3,6,3,2,10,10,10,6,11,10,2,10,6,3,10,10,10,10,10,10,6,3,6,3,6,3,10,2,6,11,10,10,2,10,6,3,6,3,10,10,2,10,2,14,3,6,3,10,10,10,2,10,6,11,2,10,10,10,6,3,2,6,3,10,10,2,10,6,11,2,6,3,2,10,6,11,10,10,2,10,6,3,6,3,2,6,3,2,10,10,10,10,6,3,6,11,2,6,3,6,3,10,6,3,10,10,10,2,10,10,10,10,6,3,10,6,7}
	cellCount := screenSize / cellSize

	
	grid := decodeMaze(gridBytes)
	pixelMatrix := drawMaze(grid, grid[size-1][size-1], screenSize)
	mazeImage := canvas.NewRasterWithPixels(func(x,y,w,h int) color.Color {
		if x >= screenSize || y >= screenSize {
			return color.RGBA{R:131, G:131, B:131, A:1}
		}
		return pixelMatrix[y][x]
	})

	g := gamelogic.NewGame(grid, cellCount)
	g.SetupFlagLogic()

	playerMarker := canvas.NewCircle(color.RGBA{R:54, G:128, B:255, A:200})
	playerMarker.Resize(fyne.NewSquareSize(cellSize / 2))

	playerPos := g.PlayerLoc
	playerMarker.Move(calcPosition(playerPos))

	content := container.NewStack(mazeImage, container.NewWithoutLayout(playerMarker))

	w.Canvas().SetOnTypedKey(func(ev *fyne.KeyEvent) {
			dx, dy := 0,0
			switch ev.Name {
			case fyne.KeyUp, fyne.KeyW, fyne.KeyK:
				dy = -1 
			case fyne.KeyDown, fyne.KeyS, fyne.KeyJ:
				dy = 1 
			case fyne.KeyLeft, fyne.KeyA, fyne.KeyH:
				dx = -1
			case fyne.KeyRight, fyne.KeyD, fyne.KeyL:
				dx = 1
			}

			newX := playerPos.ColumnIndex + dx 
			newY := playerPos.RowIndex + dy

			newPlayerPos := model.CellLocation{RowIndex: newY, ColumnIndex: newX}
			playerPos = g.MoveTo(newPlayerPos)
			if playerPos == newPlayerPos {
				g.FlagChan <- newPlayerPos
			}
			playerMarker.Move(calcPosition(playerPos))
			playerMarker.Refresh()
	})
	return content
}

func Start() {
	a := app.NewWithID("maze.ctf")
	a.Settings().SetTheme(theme.DarkTheme())

	w := a.NewWindow("Maze CTF")
	w.Resize(fyne.NewSquareSize(screenSize))
	w.CenterOnScreen()

	contentStack := mazeContent(w)
	w.SetContent(contentStack)
	w.ShowAndRun()
}
